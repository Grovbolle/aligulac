(function(){if(!this.require){var t={},e={},n=function(o,a){var c,u=r(a,o),s=e[u];if(s)return s.exports;if(!(c=t[u]||t[u=r(u,"./index")]))throw"module '"+o+"' not found";s={id:u,exports:{}};try{return e[u]=s,c(s.exports,function(t){return n(t,i(u))},s),s.exports}catch(l){throw delete e[u],l}},r=function(t,e){var n,r,i=[];n=/^\.\.?(\/|$)/.test(e)?[t,e].join("/").split("/"):e.split("/");for(var o=0,a=n.length;a>o;o++)r=n[o],".."==r?i.pop():"."!=r&&""!=r&&i.push(r);return i.join("/")},i=function(t){return t.split("/").slice(0,-1).join("/")};this.require=function(t){return n(t,"")},this.require.define=function(e){for(var n in e)t[n]=e[n]}}return this.require.define}).call(this)({aligulac:function(t,e){(function(){var n,r=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t.Aligulac=n={init:function(){var t,n,r,i;return t=e("auto_complete").AutoComplete,n=e("common").Common,r=e("genshort").GenShort,i=e("menu").Menu,i.init(),t.init(),n.init(),r.init()},init_extra:function(t){var n,i,o,a,c;return c=t.split(" "),r.call(c,"eventmgr")>=0&&(i=e("eventmgr").EventMgr,i.init()),r.call(c,"eventres")>=0&&(o=e("eventres").EventRes,o.init()),r.call(c,"clocks")>=0&&(n=e("clocks").Clocks,n.init()),r.call(c,"player_info")>=0?(a=e("player_info").PlayerInfo,a.init()):void 0}}}).call(this)},auto_complete:function(t){(function(){var e,n,r,i,o,a,c,u,s,l;l=function(t){var e,n,i,o,a;if(t&&window.localStorage){for(o=s(),o||(o=[]),e="cache"===t.type?t:{html:r(t),key:t.key,type:"cache","origin-type":""+t.type+"s"},i=function(){var t,e,n;for(n=[],t=0,e=o.length;e>t;t++)a=o[t],n.push(a.key);return n}(),n=$.inArray(t.key,i),n>-1&&o.splice(n,1);o.length>=10;)o.pop();o.unshift(e),window.localStorage.setItem("aligulac.autocomplete.caching",JSON.stringify(o))}},s=function(t){var e,n,r,i,o,a,c,u;if(i=[],window.localStorage){if(n=JSON.parse(localStorage.getItem("aligulac.autocomplete.caching")),!n)return[];if(!t)return n;for(o=0,c=n.length;c>o;o++)for(e=n[o],a=0,u=t.length;u>a;a++)r=t[a],e["origin-type"]===r&&i.push(e)}return i},r=function(t){var e,n,r,i;if("--"===t.type)return t.key="-","<a>BYE</a>";switch(t.type){case"header":return"<span class='autocomp-header'>"+autocomp_strings[t.label]+"</span>";case"player":return t.key=""+t.tag+" "+t.id,i=t.teams&&t.teams.length>0?"<span class='autocomp-team pull-right'>"+t.teams[0][0]+"</span>":"",e=t.country?"<img src='"+(flags_dir+t.country.toLowerCase())+".png' />":"",r="<img src='"+(races_dir+t.race.toUpperCase())+".png' />",n="<span>"+t.tag+"</span>","<a>"+e+r+n+i+"</a>";case"team":return t.key=t.name,"<a>"+t.name+"</a>";case"event":return t.key=t.fullname,"<a>"+t.fullname+"</a>";case"cache":return t.html}},i=function(t,e){var n,r;return null==e?e=["players","teams","events"]:"string"==typeof e&&(e=[e]),n=$.Deferred(),r=s(e),(!t||t.length<2)&&r?n.resolve({cache:r}):($.get("/search/json/",{q:t,search_for:e.join(",")}).success(function(t){return r&&(t.cache=r),n.resolve(t)}),n)},u=function(){var t;return t=$("#search_box"),t.bind("focus",function(){return $(this).autocomplete("search")}),t.autocomplete({source:function(t,e){return $.when(i(t.term)).then(function(t){var n,r,i,o,a;return o=function(t,e,n){var r,i,o;if(!t||0===t.length)return[];for(i=0,o=t.length;o>i;i++)r=t[i],r.type=e;return[{label:n,type:"header"}].concat(t)},i=o(t.players,"player","Players"),a=o(t.teams,"team","Teams"),r=o(t.events,"event","Events"),n=o(t.cache,"cache","Your recent searches"),e(i.concat(a.concat(r.concat(n))))})},minLength:0,select:function(e,n){return l(n.item),t.val(n.item.key).closest("form").submit(),!1},open:function(){return $(".ui-menu").width("auto")}}).data("ui-autocomplete")._renderItem=function(t,e){return $("<li></li>").append(r(e)).appendTo(t)}},o=function(){try{return $(".event-ac").autocomplete({source:function(t,e){return $.when(i(t.term,"events")).then(function(t){var n,r,i,o;if(null==t||null==t.events||0===t.events.length)return[];for(o=t.events,r=0,i=o.length;i>r;r++)n=o[r],n.type="event";return e(t.events)})},minLength:2,select:function(t,e){return $(".event-ac").val(e.item.key),!1},open:function(){return $(".ui-menu").width("auto")}}).data("ui-autocomplete")._renderItem=function(t,e){return $("<li></li>").append(r(e)).appendTo(t)}}catch(t){}},n=function(){return $.fn.getTags=function(){var t;return t=$(this).val().split("\n"),""===t[0]?[]:t}},c=function(){var t;return t=$("#id_players"),t.tagsInput({autocomplete_opt:{minLength:0,select:function(e,n){return l(n.item),t.addTag(n.item.key),$("#id_players_tag").focus(),!1},open:function(){return $(".ui-menu").width("auto")}},autocomplete_url:function(t,e){return $.when(i(t.term,"players")).then(function(n){var r,i,o,a;if(n.players){for(a=n.players,i=0,o=a.length;o>i;i++)r=a[i],r.type="player";!global_player_autocomplete_allow_byes||"bye"!==t.term&&"--"!==t.term||(n.players=[{type:"--"}].concat(n.players))}else n.players=[];return n.cache.unshift({value:autocomp_strings.Your_recent_searches}),e(n.players.concat(n.cache))})},defaultText:autocomp_strings.Players,placeholderColor:"#9e9e9e",delimiter:"\n",width:"100%",formatAutocomplete:r,removeWithBackspace:!0}),$("#id_players_addTag").keydown(function(t){return 13===t.which&&""===$("#id_players_tag").val()?$(this).closest("form").submit():void 0}),$("#id_players_tag").keydown(function(t){var e,n,r;return 8===t.which&&""===$(this).val()?(t.preventDefault(),e=$(this).attr("id").replace(/_tag$/,""),n=$("#"+e),r=n.getTags(),r.pop(),n.importTags(r.join("\n")),$(this).trigger("focus")):void 0})},a=function(){return $("input#id_players_tag").focus(function(){return $(this).parent().parent().css("box-shadow","inset 0 1px 1px rgba(0,0,0,.075), 0 0 4px rgba(0,0,0,.4)").css("-webkit-box-shadow","inset 0 1px 1px rgba(0,0,0,.075), 0 0 4px rgba(0,0,0,.4)").css("border-color","#000000")}).focusout(function(){return $(this).parent().parent().css("box-shadow","inset 0 1px 1px rgba(0,0,0,.075)").css("-webkit-box-shadow","inset 0 1px 1px rgba(0,0,0,.075)").css("border-color","#cccccc")})},t.AutoComplete=e={init:function(){return n(),u(),o(),c(),a()}}}).call(this)},clocks:function(t,e,n){(function(){var t,e;e=function(t){return $(t).next().toggle(),$(t).find(".clock-toggle").toggleClass("right-caret").toggleClass("down-caret")},n.exports.Clocks=t={init:function(){return $(".clock-expandable").click(function(){return e(this)})}}}).call(this)},common:function(t,e,n){(function(){var t,e,r,i,o,a,c;o=function(t){return $(".lm[data-id="+t+"]").toggle(),$(".lma[data-id="+t+"]").html($(".lma[data-id="+t+"]").html()===autocomp_strings.hide?autocomp_strings.show:autocomp_strings.hide),!1},i=function(t){return $("#fix"+t).toggle(),$("#inp"+t).toggle(),$("#"+t+"_1").focus(),!1},e=function(){return $('input[name|="match"]').prop("checked",!0),!1},a=function(){return $('input[name|="match"]').prop("checked",!1),!1},r=function(t){return $("input[data-match="+t+"]").prop("checked",!0),!1},c=function(t){return $("input[data-match="+t+"]").prop("checked",!1),!1},n.exports.Common=t={init:function(){return $(".lma").click(function(){return o($(this).data("id"))}),$(".lmp").click(function(){return i($(this).data("id"))}),$(".check-boxes-btn").click(function(){return r($(this).data("match"))}),$(".uncheck-boxes-btn").click(function(){return c($(this).data("match"))}),$(".check-all-btn").click(e),$(".uncheck-all-btn").click(a),$(".not-unique-more").click(function(){return $(this).toggle(),$(this).parent().find(".not-unique-hidden-names").toggle(),!1}),$(".not-unique-update-player").click(function(){var t,e,n,r,i,o,a;return a=$(this),i=a.data("update"),o=a.data("updateline"),n=a.data("tag"),t=a.data("id"),e=$("#"+i),r=e.getTags(),r[o]=n+" "+t,e.importTags(r.join("\n")),a.closest(".message").toggle(),!1})}}}).call(this)},eventmgr:function(t,e,n){(function(){var t,e;e=function(t,e,n){return $("#parent_id_field").val(t),$("#id_type").val(function(){switch(n){case"round":return"round";case"event":return"round";case"category":return"category"}}()),$("#parent_name").html(e),$("#md-eventmgr").modal()},n.exports.EventMgr=t={init:function(){return $(".tree-toggle").click(function(){return $(this).parent().parent().next(".subtree").toggle(100),!1}),$("#root_btn").click(function(){return $("input[id=parent_id_field]").val("-1"),$("#parent_name").html("Root (N/A)"),$("#md-eventmgr").modal(),!1}),$("#showguide").click(function(){return $("#guide").collapse(),$("#showguide").toggle()}),$(".event-modify-button").click(function(){var t,n,r;return n=$(this).data("event-fullname"),t=$(this).data("event-id"),r=$(this).data("event-type"),e(t,n,r)}),$("#id_predef_names").change(function(){return $("#id_predef_names").prop("selectedIndex")>0?($("#id_custom_names").val(""),$("#id_type").val("round")):void 0}),$("#id_custom_names").keypress(function(){return""!==$("#id_custom_names").val()?$("#id_predef_names").prop("selectedIndex",0):void 0})}}}).call(this)},eventres:function(t,e,n){(function(){var t,e,r,i;e=function(){var t,e;return e=$("#extantstories").prop("selectedIndex"),t=story_data[e],$("#story_id").prop("value",t.idx),$("#id_player").prop("value",t.player),$("#st_date").datepicker("setDate",t.dt),$("#id_text").prop("selectedIndex",t.text),$("#id_params").prop("value",t.params),$("#storynewbtn").prop("disabled",e>0),$("#storyupdbtn").prop("disabled",0===e),$("#storydelbtn").prop("disabled",0===e)},r=function(){var t;return t=$("#sortable").sortable("toArray"),$("#order").prop("value",t.join(","))},i=function(t){return $("[data-placement="+t+"]").toggle(),!1},n.exports.EventRes=t={init:function(){return $(".pp_showbtn").click(function(){return i($(this).data("placement"))}),"undefined"!=typeof admin&&null!==admin&&admin&&("undefined"!=typeof story_data&&null!==story_data&&$("#extantstories").change(e),"undefined"!=typeof has_children&&null!==has_children&&has_children)?($("#sortable").sortable(),$("#sortable").disableSelection(),$("#submit-order").click(r)):void 0}}}).call(this)},genshort:function(t,e,n){(function(){var t,e;e=function(t){return $.get("/m/new/?url="+encodeURIComponent(t),function(t){return $("#gen_short").hide(),$("#disp_short").html('<a href="/m/'+t+'/">/m/'+t+"</a>"),$("#disp_short").show()})},n.exports.GenShort=t={init:function(){return $("#gen_short").click(function(){return e(location.href)})}}}).call(this)},menu:function(t,e,n){(function(){var t,e,r;e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|OperaMini/i,r=function(){return e.test(navigator.userAgent)||$(window).width()<=768?$("a.dropdown-toggle").off("click"):$("a.dropdown-toggle").on("click",function(){return window.location.href=this.href})},n.exports.Menu=t={init:function(){return $(document).ready(r),$(window).resize(r)}}}).call(this)},player_info:function(t,e,n){(function(){var t,e;e=function(t){var e,n,r,i,o,a,c;for(e=function(e){return $(t).closest("tr").data(e)},r=["id","country","birthday","name","romanized-name"],c=[],o=0,a=r.length;a>o;o++)n=r[o],i=e(n),c.push($("#id_"+n.replace("-","_")).val(i));return c},n.exports.PlayerInfo=t={init:function(){return $(".player-info-edit-button").click(function(){return e(this)}),$("#country_filter").change(function(){return $(this).closest("form").submit()})}}}).call(this)}});